---
// Generated by Copilot
// @ts-nocheck
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import './../components/animations.css';
import BarGraph from '../components/Graphs/BarGraph.astro';
import Background from './../components/Background/Rotating-Circles.astro';


const posts = await getCollection('posts');
const tagCounts = posts.reduce((acc, post) => {
  post.data.tags.forEach(tag => {
    acc[tag] = (acc[tag] || 0) + 1;
  });
  return acc;
}, {})
const formattedTags = Object.entries(tagCounts).map((item) => {
  return {tag: item[0], count: item[1]}
});

const sortedTags = Object.entries(tagCounts).sort((a, b) => {
  return Number(b[1]) - Number(a[1]); // Ensure values are numbers
});
---

<Layout title="Tags">
  <Background />
  <h1 style="text-align: center;">Histogram of Post Tags</h1>
  <div style="text-align: center;">
    <ul style="list-style: none; padding: 0;">
      {sortedTags.map(([tag, count]) => (
        <li id={tag} class="text-large scale-on-hover" style="display: inline-block; margin: 0 10px;">
          <a href={`/tags/${tag}`} class="tag-link">#{tag}</a> ({count})
        </li>
      ))}
    </ul>
  </div>
  <BarGraph height="60vh" data={formattedTags} />
</Layout>